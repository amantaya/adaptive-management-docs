---
title: "clean-up-tables-from-access-database"
author: "Cameron Burleson"
date: "3/28/2022"
output:
  pdf_document: default
  html_document: default
---

Remove all of the objects from the R environment to start fresh every time.
```{r}
rm(list = ls())
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load pacman package}
library("pacman")
```

```{r load all packages}
source("packages.R")
```

```{r load custom functions}
source("functions.R")
```

```{r add file path}
path_to_excel_file <- file.path("data", "adaptive_management_documents_asessment_export_all_tables_from_access.xlsx")

print(path_to_excel_file)
```

Read in the sheet names from the Excel workbook.

```{r get sheet names}
sheet_names <- openxlsx::getSheetNames(path_to_excel_file)

print(sheet_names)
```

```{r load in data from Excel}
all_excel_sheets_list <- lapply(sheet_names, openxlsx::read.xlsx, xlsxFile = path_to_excel_file)

all_excel_sheets_list
```

```{r}
df <- all_excel_sheets_list[[1]]

df
```


```{r}
names(df)
```

```{r}
any(names(df) == "Date.Entered")
```

```{r}
convert_from_excel_dates_to_datetime(df)

print(df)
```

```{r map custom clean dates fucntion to list of data frames}
all_excel_sheets_cleaned_entered_dates_list <- purrr::map(all_excel_sheets_list, convert_from_excel_dates_to_datetime)

print(all_excel_sheets_cleaned_entered_dates_list)
```

The "CodingDate" column means exactly the same as "Date.Entered" and we can rename that column to be the same thing. Then we could run our function on the previously names "CodingDate" column.

The "DateOn" and "DateOff" columns are the dates that cows were turned out onto pasture and removed from pastures. These columns also need to be converted into Date class.

In the "DocSpecs" data frame the "DocYear" column was coded in using a table of codes from the dmnSpecs

We want to keep only these tables from the Access database.

```{r}
# tblAllotSpecs

# tblAllotmentKeySpecies

# tblAllotSpecs

# tblAllotStrategies

# tblAmendSpecs

# tblClimeChange_Doc

# tblPastureSpecs
```



